<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <!--bootstrap css-->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <!--google icon-->
      <link
    href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
    rel="stylesheet">

      <!--jquery-->
      <Script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></Script>

      <title>BookStar</title>
</head>

<style>
   .main_body {
      flex-direction: column;
      display: flex;
      width: 100%;
      height: 900px;
      margin: 0 auto;
      align-items: center;
      padding-top:70px;
      background-color: #efefef;
   }

   .left_body {
          background-color: #ffffff;
          margin-right: 100px;
          width: 800px;
          height: 2000px;
          display: flex;
          padding-top: 50px;
          flex-direction: column;
          align-items: center;
      }

  .button{
      width: 400px;
      height: 50px;
      background-color: #ffffff;
      color: #555454;
      font-size: 16px;
      border-color: #e1e1e1;
      cursor: pointer;
      transition: background-color 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }
  .button:hover{
      background-color: #ededed;
  }

  .box {
      display: none;
      width: 100%;
      height: 700px;
      margin-top: 20px;
      background-color: #c3c3c3;
  }


</style>

<body>
    <!--ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°”-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light"
    style="width:100%; height:50px; position:fixed;">
      <div class="container-fluid">
          <img style="height: 30px; object-fit: contain" src="https://cdn-icons-png.flaticon.com/512/864/864685.png">
          <input class="form-control" style="width: 200px" type="search" placeholder="Search" aria-label="Search">

          <div>
            <span id="home" class="material-icons" style="cursor: pointer;">home</span>
            <!--
            <span id="login" class="material-icons-outlined">login</span>
            <span id="join" class="material-icons-outlined">person</span>
            -->
          </div>
      </div>
    </nav>

  <div class="main_body">
  <div class="left_body">
    <h1 style="margin-bottom: 30px; color: #504f4f; font-weight: bold;">ë„ì„œ ì¶”ì²œ í˜ì´ì§€</h1>

    <!-- âœ… ë³€ê²½ í›„ -->
<div style="display: flex; flex-direction: column; gap: 10px; align-items: center;">
  <div style="display: flex; gap: 10px;">
    <button class="button" id="btn1">ì¶”ì²œ ì±… ë³´ê¸°</button>
    <button class="button" id="btn2">ìƒˆë¡œìš´ ì±… ë³´ê¸°</button>
  </div>
  <button class="button" id="btn3">ğŸ“š ì±… ê²€ìƒ‰í•˜ê¸°</button> <!-- â¬…ï¸ ì•„ë˜ì— ìœ„ì¹˜ -->
</div>


    <!-- âœ… ê²€ìƒ‰ì°½ ë° ê²°ê³¼ ë°•ìŠ¤ -->
    <div class="box" id="box3">
      <div class="input-group p-3" style="width: 90%;">
        <input type="text" id="searchInput" class="form-control" placeholder="ì±… ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
        <button class="btn btn-primary" id="searchButton">ê²€ìƒ‰</button>
      </div>
      <div id="searchResults" class="p-3"></div>
    </div>

    <!--ê´€ë ¨ ì¶”ì²œ ë„ì„œ-->
    <div class="box" id="box1">
      <div id="recommendation-list">
        <p>ì¶”ì²œ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
      </div>
    </div>

    <!--ê´€ë ¨ë˜ì§€ ì•Šì€ ì¶”ì²œ ë„ì„œ-->
    <div class="box" id="box2"></div>

<script>
  const btn1 = document.getElementById("btn1");
  const btn2 = document.getElementById("btn2");
  const btn3 = document.getElementById("btn3"); // âœ… ì¶”ê°€

  const box1 = document.getElementById("box1");
  const box2 = document.getElementById("box2");
  const box3 = document.getElementById("box3"); // âœ… ì¶”ê°€

  btn1.addEventListener("click", () => {
    box1.style.display = "block";
    box2.style.display = "none";
    box3.style.display = "none";

    fetch("/book/recommend/?user_id=í™ì†ì—ì €ë°”ëŒì†ì—")
      .then(response => response.json())
      .then(data => {
        const list = document.getElementById("recommendation-list");
        list.innerHTML = "";
        if (data.results) {
          data.results.forEach((item, idx) => {
            const div = document.createElement("div");
            div.innerText = `${idx + 1}. ${item[1]} (ID: ${item[0]})`;
            list.appendChild(div);
          });
        } else {
          list.innerText = "ì¶”ì²œ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.";
        }
      })
      .catch(error => {
        document.getElementById("recommendation-list").innerText = "ì˜¤ë¥˜ ë°œìƒ";
        console.error("ì¶”ì²œ ì˜¤ë¥˜:", error);
      });
  });

  btn2.addEventListener("click", () => {
    box2.style.display = "block";
    box1.style.display = "none";
    box3.style.display = "none";
  });

  btn3.addEventListener("click", () => {
    box3.style.display = "block";
    box1.style.display = "none";
    box2.style.display = "none";
  });

  // ê²€ìƒ‰ ê¸°ëŠ¥
  document.getElementById("searchButton").addEventListener("click", function() {
    const query = document.getElementById("searchInput").value.trim();
    if (!query) {
      alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
      return;
    }

    fetch(`/book/search/naver_xml/?query=${encodeURIComponent(query)}`)
      .then(response => response.json())
      .then(data => {
        const resultDiv = document.getElementById("searchResults");
        resultDiv.innerHTML = "";

        if (data.items && data.items.length > 0) {
          data.items.forEach(item => {
            const element = document.createElement("div");
            element.className = "card p-3 mb-3";
            element.innerHTML = `
              <h5>${item.title}</h5>
              <p><strong>ì €ì:</strong> ${item.author}</p>
              <p>${item.description}</p>
              <a href="${item.link}" target="_blank">ìì„¸íˆ ë³´ê¸°</a>
            `;
            resultDiv.appendChild(element);
          });
        } else {
          resultDiv.innerHTML = "<p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
        }
      })
      .catch(err => {
        console.error("ì˜¤ë¥˜:", err);
        document.getElementById("searchResults").innerHTML = "<p>ì˜¤ë¥˜ ë°œìƒ</p>";
      });
  });

  // í™ˆ ì•„ì´ì½˜
  const homeIcon = document.getElementById("home");
  if (homeIcon) {
    homeIcon.addEventListener("click", () => {
      window.location.href = "/";
    });
  }
</script>

    </div>
    </div>
</body>
</html>